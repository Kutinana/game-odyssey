<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>é¦™æ¸¯ä¸­æ–‡å¤§å­¦ï¼ˆæ·±åœ³ï¼‰æ¸¸æˆç ”ç©¶ç¤¾</title>
    
    <meta data-locale-title="cn" content="">
    <meta data-locale-title="en" content="Space Bar â˜† Porter q(â‰§â–½â‰¦q)">
    
    <script>
      // Apply saved theme early to avoid FOUC
      (function() {
        try {
          var saved = localStorage.getItem('theme');
          var systemDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
          var isDark = saved ? saved === 'dark' : systemDark;
          var root = document.documentElement;
          if (isDark) root.classList.add('dark'); else root.classList.remove('dark');
        } catch (e) {}
      })();
      // Expose scrollbar width as CSS var (--sbw) to avoid 100vw overflow issues
      (function(){
        try {
          var root = document.documentElement;
          function setSBW(){
            var sbw = window.innerWidth - root.clientWidth;
            root.style.setProperty('--sbw', (sbw > 0 ? sbw : 0) + 'px');
          }
          setSBW();
          window.addEventListener('resize', setSBW, { passive: true });
        } catch(e) {}
      })();
      // Apply persisted fonts-loaded flag early to avoid re-swap
      (function(){
        try {
          var has = localStorage.getItem('fonts-loaded') === '1';
          var check = function(q){ try { return document.fonts && document.fonts.check(q); } catch(e){ return false; } };
          if (has && (check('400 1em "LXGWBright"') || check('1em LXGWBright'))) {
            document.documentElement.classList.add('fonts-loaded');
          }
        } catch (e) {}
      })();
    </script>
    <link rel="stylesheet" href="/assets/styles.css">
    <link rel="preload" href="/assets/fonts/LXGWBright-Light.woff2" as="font" type="font/woff2" crossorigin>
    <link rel="preload" href="/assets/fonts/LXGWBright-LightItalic.woff2" as="font" type="font/woff2" crossorigin>
    <link rel="preload" href="/assets/fonts/LXGWBright-Regular.woff2" as="font" type="font/woff2" crossorigin>
    <link rel="preload" href="/assets/fonts/LXGWBright-Italic.woff2" as="font" type="font/woff2" crossorigin>
    <script>
      // Persist fonts-loaded after first success in this or any tab
      (function(){
        if (!('fonts' in document)) return;
        try {
          var promises = [
            document.fonts.load('400 1em "LXGWBright"'),
            document.fonts.load('700 1em "LXGWBright"'),
            document.fonts.load('italic 400 1em "LXGWBright"'),
            document.fonts.load('italic 700 1em "LXGWBright"')
          ];
          Promise.all(promises).then(function(){
            document.documentElement.classList.add('fonts-loaded');
            try { localStorage.setItem('fonts-loaded','1'); } catch(e) {}
          });
        } catch (e) {}
      })();
    </script>
  </head>
  <body class="bg-neutral-50 text-neutral-900 dark:bg-neutral-950 dark:text-neutral-100 selection:bg-indigo-500/30">
    <header class="fixed top-0 inset-x-0 z-50">
      <nav class="max-w-6xl mx-auto mt-2 px-4 py-2 rounded-xl border border-black/5 dark:border-white/10 bg-white/40 dark:bg-neutral-900/30 backdrop-blur-2xl">
          <div class="flex items-center justify-between">
            <a href="/" class="text-sm font-semibold tracking-wide text-neutral-900 dark:text-neutral-100" data-i18n="site.title">
              é¦™æ¸¯ä¸­æ–‡å¤§å­¦ï¼ˆæ·±åœ³ï¼‰æ¸¸æˆç ”ç©¶ç¤¾
            </a>
            <div id="navTabs" data-active="projects" class="hidden md:flex relative items-center gap-3 text-sm">
              <span id="navIndicator" class="nav-indicator absolute rounded-lg opacity-0"></span>
              <a href="/" data-tab="home" data-nav class="px-3 py-1 rounded-lg transition-colors text-neutral-600 dark:text-neutral-300 hover:text-neutral-900 dark:hover:text-white" data-i18n="nav.home">Home</a>
              <a href="/projects/" data-tab="projects" data-nav class="px-3 py-1 rounded-lg transition-colors text-neutral-900 dark:text-white" data-i18n="nav.projects">Projects</a>
              <a href="/about/" data-tab="about" data-nav class="px-3 py-1 rounded-lg transition-colors text-neutral-600 dark:text-neutral-300 hover:text-neutral-900 dark:hover:text-white" data-i18n="nav.about">About</a>
            </div>
            <div class="flex items-center gap-2">
              <button id="themeToggle" aria-label="Toggle theme" class="inline-flex items-center justify-center w-9 h-9 rounded-lg border border-black/5 dark:border-white/10 bg-white/40 hover:bg-white/60 dark:bg-neutral-800/30 dark:hover:bg-neutral-700/40 text-neutral-900 dark:text-neutral-100 transition-colors">
                <svg id="iconMoon" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="currentColor" viewBox="0 0 20 20"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"/></svg>
                <svg id="iconSun" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 hidden" fill="currentColor" viewBox="0 0 20 20"><path d="M10 15a5 5 0 100-10 5 5 0 000 10zm0 5a1 1 0 011-1h0a1 1 0 110 2h0a1 1 0 01-1-1zm0-20a1 1 0 011 1h0a1 1 0 11-2 0h0a1 1 0 011-1zm10 10a1 1 0 01-1 1h0a1 1 0 110-2h0a1 1 0 011 1zM1 10a1 1 0 011-1h0a1 1 0 110 2h0A1 1 0 011 10zm15.657-6.657a1 1 0 010 1.414h0a1 1 0 11-1.414-1.414h0a1 1 0 011.414 0zM4.757 15.243a1 1 0 010 1.414h0a1 1 0 11-1.414-1.414h0a1 1 0 011.414 0zM15.657 15.243a1 1 0 011.414 0h0a1 1 0 11-1.414 1.414h0a1 1 0 010-1.414zM4.757 4.757A1 1 0 003.343 3.343h0A1 1 0 114.757 4.757z"/></svg>
              </button>
              <button id="langToggle" class="text-sm px-3 py-2 rounded-lg border border-black/5 dark:border-white/10 bg-white/40 hover:bg-white/60 dark:bg-neutral-800/30 dark:hover:bg-neutral-700/40 text-neutral-900 dark:text-neutral-100 transition-colors">EN</button>
            </div>
          </div>
      </nav>
    </header>

    <div id="swup" class="swup-fade opacity-0">
      <main class="max-w-6xl mx-auto p-4 pt-24">
        










<section class="relative h-72 w-full overflow-hidden mb-6 bg-white dark:bg-transparent left-1/2 -translate-x-1/2" style="width:calc(100vw - var(--sbw, 0px));margin-top:-6rem;">
  
  <div class="absolute inset-0 hero-bg" style="background-image:url('/projects/space-bar-porter/banner.jpg')"></div>
  <div class="absolute inset-0 hero-overlay"></div>
  <div class="relative z-10 h-full flex items-center justify-center text-center">
    
    <div>
      <h1 class="text-3xl font-bold tracking-tight text-neutral-900 dark:text-white drop-shadow-sm">Space Bar â˜† Porter q(â‰§â–½â‰¦q)</h1>
      
      
      <p class="mt-2 text-base sm:text-lg text-neutral-900 dark:text-neutral-100 drop-shadow-sm">54*0.7</p>
      
    </div>
    
  </div>
</section>


<article class="max-w-3xl mx-auto p-4">
  
  
  
  
  
  
  
  
  
  
  <meta data-locale-title="cn" content="">
  <meta data-locale-title="en" content="Space Bar â˜† Porter q(â‰§â–½â‰¦q)">
  
  
  
  
  
  
  
  
  
  <div>
    <article data-locale="cn" class="md-content" style="display:none"><p>æ¬¢è¿æ¥åˆ°ç©ºæ ¼ â˜† é€Ÿè¿ q(â‰§â–½â‰¦q)ï¼Œç»ˆæå¯çˆ±çš„ï¼Œåªç»™ä½ ç”¨æœ‰é™ç©ºæ ¼é”®ï¼ˆSpace Barï¼‰çš„å¹³å°è·³è·ƒè§£è°œæ¸¸æˆã€‚</p>
<h1>æ¸¸æˆä»‹ç»</h1>
<hr>
<h2>ç‰¹ç‚¹</h2>
<ul>
<li>ä¸»è§’æ˜¯ä¸€ä½è¶…å¯è€çš„å¥³å­©çº¸å¿«é€’å‘˜ã€‚</li>
<li>å¤šç§å¸¸è§çš„å¹³å°è·³è·ƒæ¸¸æˆæ“ä½œï¼ˆç»‘å®šç©ºæ ¼é”®ï¼‰ï¼ŒåŒ…æ‹¬
<ul>
<li>è·³è·ƒ</li>
<li>åè½¬é‡åŠ›</li>
<li>å†²åˆº</li>
</ul>
</li>
<li>å…³å¡ä¸­ç©ºæ ¼é”®ä½¿ç”¨æ¬¡æ•°æœ‰é™</li>
<li>å¯æ‰§è¡Œç©ºæ ¼é”®æ“ä½œçš„ç©ºé—´ä¹Ÿæœ‰é™
<ul>
<li>åœ¨çº¢è‰²ç©ºé—´ï¼Œä½ å¯ä»¥è·³è·ƒã€‚ğŸ¦¶</li>
<li>åœ¨è“è‰²ç©ºé—´ï¼Œä½ å¯ä»¥åè½¬é‡åŠ›ã€‚ğŸ”„</li>
<li>åœ¨é»„è‰²ç©ºé—´ï¼Œä½ å¯ä»¥å†²åˆºç¬ç§»ã€‚ğŸ’¨</li>
</ul>
</li>
<li><s>å¾ˆå¤šè®©ä½ æ§è…¹å¤§ç¬‘çš„ neta</s></li>
</ul>
<h2>æ§åˆ¶</h2>
<ul>
<li>æŒ‰ Aã€D å‘å·¦å³ç§»åŠ¨ã€‚</li>
<li>ç©ºæ ¼é”®è·³è·ƒã€åè½¬é‡åŠ›æˆ–å†²åˆºç¬ç§»ã€‚</li>
</ul>
<h2>å‰§æƒ…</h2>
<ul>
<li>æ˜¯çš„ï¼Œå’±æœ‰å‰§æƒ…ã€‚</li>
<li>æ‰®æ¼”â€œå¿«é€’å°é¸½â€ï¼Œ åœ¨å±±å§†é€Ÿè¿å·¥ä½œçš„æ‘†çƒ‚å®…å¥³å¿«é€’å‘˜ã€‚</li>
<li>è¢«å·å…¥â€œ<em>ç§»åŠ¨å®‡å®™</em>â€ä¸­çš„å¤§å±æœºï¼Œé€é€å¿«é€’ï¼Œé¡ºä¾¿é˜»æ­¢â€œ<em>é™æ­¢ä¸åŠ¨åŠ›</em>â€ åœ¨å®‡å®™ä¸­çš„æ‰©æ•£ã€‚</li>
<li>ä»å„ä¸ªâ€œç§»åŠ¨ç©ºé—´â€ä¸­è®¤è¯†ä¸åŒæœ‰è¶£è§’è‰²ã€‚</li>
<li><s>çœŸæ­£çš„æ­»äº¡ææµ…ç¬¬15ç« </s></li>
</ul>
<h2>è§’è‰²</h2>
<ul>
<li>Bro
<img src="./assets/heroine.gif" alt="Bro">
<ul>
<li>æ…µæ‡’å®…å¥³ï¼Œå±±å§†é€Ÿè¿å¿«é€’å‘˜ã€‚</li>
<li>ç»©æ•ˆå¾ˆä½ï¼Œå†ä¸å¹²è¿™å•è¦è¢«ç‚’äº†ã€‚</li>
</ul>
</li>
<li>Sam
<img src="./assets/sam.png" alt="Sam">
<ul>
<li>å±±å§†é€Ÿè¿çš„è€æ¿ã€‚</li>
<li><s>ä¸æ˜¯é‚£ä¸ªå±±å§†Â·æ³¢ç‰¹</s></li>
</ul>
</li>
<li>Jumbo
<img src="./assets/jumpo.png" alt="Jumpo">
<ul>
<li><em>è·³è·ƒç©ºé—´</em> çš„æ€»ç»Ÿã€‚</li>
<li><s>è®©è·³è·ƒç©ºé—´å†æ¬¡ä¼Ÿå¤§</s></li>
</ul>
</li>
<li>Garry
<img src="./assets/garry.png" alt="Garry">
<ul>
<li><em>é‡åŠ›ç©ºé—´</em> çš„ç‹ç‹¸å›½ç‹ã€‚</li>
<li>åœ¨å¾ˆå¤§çš„â€¦é‡åŠ›ä¸‹å·¥ä½œã€‚</li>
</ul>
</li>
<li>Dashmond
<img src="./assets/dashmond.png" alt="Dashmond">
<ul>
<li><em>å†²åˆºç©ºé—´</em> çš„å¤§åŠ›ç‹æ€»ç†</li>
<li><s>What is love? Baby donâ€™t hurt me.</s></li>
</ul>
</li>
</ul>
<h1>ç›¸å…³é“¾æ¥</h1>
<hr>
<p>Itch ä»‹ç»é¡µï¼š<a href="https://kuchinashi.itch.io/space-bar-porter">Space Bar â˜† Porter q(â‰§â–½â‰¦q)</a></p>
</article>
    <article data-locale="en" class="md-content" style="display:none"><p>Welcome to Space Bar â˜† Porter q(â‰§â–½â‰¦q), the kawaii puzzle platformer with LIMITED SPACE BARs to use.</p>
<h1>Introduction</h1>
<hr>
<h2>Feature</h2>
<ul>
<li>A cute girl porter as the protagnist.</li>
<li>Multiple common platformer operations (linked to your SPACE BAR) in a nutshell including:
<ul>
<li>Jump</li>
<li>Reverse Gravity</li>
<li>Dash</li>
</ul>
</li>
<li>LIMITED space bar usage in a stage</li>
<li>Also LIMITED SPACE where you can perform all the operations
<ul>
<li>In red spaces, you can jump.ğŸ¦¶</li>
<li>In blue spaces, you can reverse gravity.ğŸ”„</li>
<li>In yellow spaces,you can dash. ğŸ’¨</li>
</ul>
</li>
<li><s>lots of neta features to make you laugh</s></li>
</ul>
<h2>Control</h2>
<ul>
<li>Use A, D to move left and right.</li>
<li>SPACE BAR to jump, reverse gravity, or dash.</li>
</ul>
<h2>Plot</h2>
<ul>
<li>Yes, a plot.</li>
<li>Act as Bro, the otaku girl porter whoâ€™s performing poorly in her company Sam Exress.</li>
<li>Invloved in a crisis in the <em>Moving-Verse</em>, resisting the spread of <em>Still Force</em> while delivering cargos.</li>
<li>Meet interesting characters from different spaces.</li>
<li><s>Tomorrow is in your hands.</s></li>
</ul>
<h2>Characters</h2>
<ul>
<li>Bro
<img src="./assets/heroine.gif" alt="Bro">
<ul>
<li>A lazy otaku girl ãƒ¾(â‰§â–½â‰¦*)o whoâ€™s working in Sam Express</li>
<li>Performing so poorly that if didnâ€™t finish the delivery in the game, she will be fired.</li>
</ul>
</li>
<li>Sam
<img src="./assets/sam.png" alt="Sam">
<ul>
<li>Boss of Sam Express.</li>
<li><s>Not that Sam Porter</s>.</li>
</ul>
</li>
<li>Jumbo
<img src="./assets/jumpo.png" alt="Jumpo">
<ul>
<li>President of the <em>Jump Space</em>.</li>
<li>Want to make <em>Jump Space</em> great again.</li>
</ul>
</li>
<li>Garry
<img src="./assets/garry.png" alt="Garry">
<ul>
<li>The fox king of the <em>Gravity Space</em>.</li>
<li>Working under hugeâ€¦gravity.</li>
</ul>
</li>
<li>Dashmond
<img src="./assets/dashmond.png" alt="Dashmond">
<ul>
<li>The big muscle chancellor of <em>Dash Space</em>.</li>
<li><s>What is love? Baby donâ€™t hurt me.</s></li>
</ul>
</li>
</ul>
<h1>Links</h1>
<hr>
<p>Itch Portalï¼š<a href="https://kuchinashi.itch.io/space-bar-porter">Space Bar â˜† Porter q(â‰§â–½â‰¦q)</a></p>
</article>
  </div>
  
  
  <section class="mt-8">
    <div class="md-content mb-3">
      <h1>
        <span data-locale="cn" style="display:none">æˆªå›¾</span>
        <span data-locale="en" style="display:none">Screenshots</span>
      </h1>
      <hr />
    </div>
    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
      
        
          <img src="/projects/space-bar-porter/screenshots/1.jpg" alt="screenshot 1" class="w-full rounded-md cursor-zoom-in js-shot" data-index="0" />
        
      
      
    </div>
  </section>
  
  <script>
    (function(){
      try {
        var locale = localStorage.getItem('locale') || 'cn';
        if (locale === 'zh') locale = 'cn';
        document.querySelectorAll('[data-locale]').forEach(function(el){
          el.style.display = (el.getAttribute('data-locale') === locale ? '' : 'none');
        });
      } catch (e) {}

      // Lightbox implementation
      try {
        var shots = [
          
            "/projects/space-bar-porter/screenshots/1.jpg"
          
        ];

        if (Array.isArray(shots) && shots.length) {
          var current = 0;

          // Create lightbox container
          var lb = document.createElement('div');
          lb.setAttribute('id', 'lightbox');
          lb.className = 'fixed inset-0 hidden items-center justify-center z-50';

          lb.innerHTML = ''+
            '<div data-el="backdrop" class="absolute inset-0 bg-black/80 opacity-0 transition-opacity duration-200"></div>'+
            '<div class="relative px-8 pt-4 pb-6">'+
              '<img data-el="image" alt="screenshot" class="mx-auto w-auto h-auto max-w-[90vw] max-h-[85vh] rounded-md shadow-lg transform scale-95 opacity-0 transition duration-200" />'+
            '</div>'+
            '<button type="button" data-el="close" aria-label="Close" class="absolute top-4 right-4 text-white/90 hover:text-white text-2xl leading-none">Ã—</button>'+
            '<button type="button" data-el="prev" aria-label="Previous" class="absolute left-4 top-1/2 -translate-y-1/2 w-10 h-10 rounded-full bg-black/50 hover:bg-black/60 text-white flex items-center justify-center border border-white/20 shadow-lg focus:outline-none focus-visible:ring-2 focus-visible:ring-white/60">â€¹</button>'+
            '<button type="button" data-el="next" aria-label="Next" class="absolute right-4 top-1/2 -translate-y-1/2 w-10 h-10 rounded-full bg-black/50 hover:bg-black/60 text-white flex items-center justify-center border border-white/20 shadow-lg focus:outline-none focus-visible:ring-2 focus-visible:ring-white/60">â€º</button>'+
            '<div data-el="counter" class="absolute bottom-4 left-1/2 -translate-x-1/2 text-white/85 text-sm"></div>';

          document.body.appendChild(lb);

          var elBackdrop = lb.querySelector('[data-el="backdrop"]');
          var elImage = lb.querySelector('[data-el="image"]');
          var elClose = lb.querySelector('[data-el="close"]');
          var elPrev = lb.querySelector('[data-el="prev"]');
          var elNext = lb.querySelector('[data-el="next"]');
          var elCounter = lb.querySelector('[data-el="counter"]');

          function updateCounter(){
            elCounter.textContent = (current + 1) + ' / ' + shots.length;
          }

          function show(index){
            if (index < 0) index = shots.length - 1;
            if (index >= shots.length) index = 0;
            current = index;
            elImage.src = shots[current];
            updateCounter();
            lb.classList.remove('hidden');
            lb.classList.add('flex');
            requestAnimationFrame(function(){
              elBackdrop.classList.add('opacity-100');
              elImage.classList.remove('scale-95','opacity-0');
              elImage.classList.add('scale-100','opacity-100');
            });
          }

          function hide(){
            elBackdrop.classList.remove('opacity-100');
            elImage.classList.remove('scale-100','opacity-100');
            elImage.classList.add('scale-95','opacity-0');
            setTimeout(function(){
              lb.classList.remove('flex');
              lb.classList.add('hidden');
            }, 180);
          }

          elClose.addEventListener('click', function(){ hide(); try { this.blur(); } catch(e) {} });
          elBackdrop.addEventListener('click', hide);
          elPrev.addEventListener('click', function(){ show(current - 1); try { this.blur(); } catch(e) {} });
          elNext.addEventListener('click', function(){ show(current + 1); try { this.blur(); } catch(e) {} });

          document.addEventListener('keydown', function(e){
            if (lb.classList.contains('hidden')) return;
            if (e.key === 'Escape') hide();
            else if (e.key === 'ArrowLeft') show(current - 1);
            else if (e.key === 'ArrowRight') show(current + 1);
          });

          // Bind thumbnails
          document.querySelectorAll('.js-shot').forEach(function(node){
            node.addEventListener('click', function(){
              var idx = parseInt(node.getAttribute('data-index') || '0', 10) || 0;
              show(idx);
            });
          });
        }
      } catch (err) {
        // noop
      }
    })();
  </script>
 </article>


      </main>
    </div>

    <script>
      (function() {
        // Register service worker for font caching
        try {
          if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('/sw.js');
          }
        } catch (e) {}
        var root = document.documentElement;
        var btn = document.getElementById('themeToggle');
        var iconMoon = document.getElementById('iconMoon');
        var iconSun = document.getElementById('iconSun');
        function setIcon(dark) {
          if (!iconMoon || !iconSun) return;
          if (dark) { iconMoon.classList.add('hidden'); iconSun.classList.remove('hidden'); }
          else { iconSun.classList.add('hidden'); iconMoon.classList.remove('hidden'); }
        }
        // Do not bind here to avoid double handlers; handled in bindUi()

        // Minimal i18n for nav and CTA
        var dict = { cn: {"site.title":"é¦™æ¸¯ä¸­æ–‡å¤§å­¦ï¼ˆæ·±åœ³ï¼‰æ¸¸æˆç ”ç©¶ç¤¾","site.description":"ç©è€ï¼Œåˆ›é€ ï¼Œåˆ†äº«","nav.home":"é¦–é¡µ","nav.projects":"é¡¹ç›®","nav.about":"å…³äº","hero.cta":"æŸ¥çœ‹é¡¹ç›®","project.recruiting":"æ‹›å‹Ÿä¸­","project.screenshots":"æˆªå›¾","project.screenshots.more":"è¿˜æœ‰æ›´å¤šâ€¦â€¦","projects.search.placeholder":"æœç´¢é¡¹ç›®ã€å›¢é˜Ÿæˆ–æ ‡ç­¾","projects.filter.recruiting":"åªçœ‹æ‹›å‹Ÿä¸­"}, en: {"site.title":"CUHK(SZ) Gaming Odyssey","site.description":"Play, Create, Share","nav.home":"Home","nav.projects":"Projects","nav.about":"About","hero.cta":"View Projects","project.recruiting":"Recruiting","project.screenshots":"Screenshots","project.screenshots.more":"and more....","projects.search.placeholder":"Search projects, teams or tags","projects.filter.recruiting":"Recruiting only","home.recent.title":"Recent Projects","home.recent.viewAll":"View all projects"} };
        var rootLocale = (localStorage.getItem('locale') || 'cn');
        if (rootLocale === 'zh') rootLocale = 'cn';
        var langToggle = document.getElementById('langToggle');
        function applyLocale(locale) {
          // Backward compatibility: map 'zh' -> 'cn'
          if (locale === 'zh') locale = 'cn';
          var data = (dict && dict[locale]) || (dict && dict.cn) || {};
          // Optional per-page localized title from meta tags (set server-side)
          document.querySelectorAll('[data-i18n]').forEach(function(el) {
            var key = el.getAttribute('data-i18n');
            if (data[key]) el.textContent = data[key];
          });
          root.setAttribute('lang', locale === 'en' ? 'en' : 'zh-CN');
          // Toggle any localized elements (titles, team, markdown, etc.)
          try {
            document.querySelectorAll('[data-locale]')
              .forEach(function(el){ el.style.display = (el.getAttribute('data-locale') === locale ? '' : 'none'); });
            // Update <title> if per-page localized title is provided
            try {
              var metaCn = document.querySelector('meta[data-locale-title="cn"]');
              var metaEn = document.querySelector('meta[data-locale-title="en"]');
              var t = (locale === 'en' ? (metaEn && metaEn.getAttribute('content')) : (metaCn && metaCn.getAttribute('content')));
              if (t && typeof t === 'string' && t.trim().length > 0) { document.title = t; }
            } catch (e) {}
            // Reposition nav indicator after labels change width
            var nav = document.getElementById('navTabs');
            var indicator = document.getElementById('navIndicator');
            if (nav && indicator) {
              var activeKey = nav.getAttribute('data-active');
              var target = nav.querySelector('a[data-tab="' + activeKey + '"]');
              if (target) {
                var r = target.getBoundingClientRect();
                var nr = nav.getBoundingClientRect();
                indicator.style.left = (r.left - nr.left - 4) + 'px';
                indicator.style.width = (r.width + 8) + 'px';
                indicator.style.top = (r.top - nr.top - 2) + 'px';
                indicator.style.opacity = '1';
              }
            }
          } catch (e) {}
        }
        function bindUi() {
          // Re-select elements after page replacement
          btn = document.getElementById('themeToggle');
          iconMoon = document.getElementById('iconMoon');
          iconSun = document.getElementById('iconSun');
          langToggle = document.getElementById('langToggle');
          // Nav indicator follow
          try {
            var nav = document.getElementById('navTabs');
            var indicator = document.getElementById('navIndicator');
            if (nav && indicator) {
              var tabs = Array.prototype.slice.call(nav.querySelectorAll('a[data-tab]'));
              function positionTo(el) {
                var r = el.getBoundingClientRect();
                var nr = nav.getBoundingClientRect();
                indicator.style.left = (r.left - nr.left - 4) + 'px';
                indicator.style.width = (r.width + 8) + 'px';
                indicator.style.top = (r.top - nr.top - 2) + 'px';
                indicator.style.opacity = '1';
              }
              var activeKey = nav.getAttribute('data-active');
              var activeEl = tabs.find(function(t){ return t.getAttribute('data-tab') === activeKey; }) || tabs[0];
              if (activeEl) positionTo(activeEl);
              tabs.forEach(function(t){
                t.addEventListener('mouseenter', function(){ positionTo(t); });
              });
              nav.addEventListener('mouseleave', function(){ if (activeEl) positionTo(activeEl); });
            }
          } catch (e) {}
          setIcon(root.classList.contains('dark'));
          if (btn) {
            btn.setAttribute('aria-pressed', String(root.classList.contains('dark')));
          }
          if (btn && !btn._bound) {
            btn.addEventListener('click', function() {
              var isDark = root.classList.toggle('dark');
              localStorage.setItem('theme', isDark ? 'dark' : 'light');
              setIcon(isDark);
              btn.setAttribute('aria-pressed', String(isDark));
            });
            btn._bound = true;
          }
          try {
            var savedLocale = localStorage.getItem('locale');
            if (!savedLocale) {
              var navLang = (navigator.languages && navigator.languages[0]) || navigator.language || '';
              navLang = String(navLang || '').toLowerCase();
              var sys = (navLang.indexOf('zh') === 0 || navLang.indexOf('cn') === 0) ? 'cn' : 'en';
              localStorage.setItem('locale', sys);
              savedLocale = sys;
            }
            if (savedLocale === 'zh') savedLocale = 'cn';
            if (langToggle) { langToggle.textContent = savedLocale === 'en' ? 'EN' : 'CN'; }
            applyLocale(savedLocale);
            if (langToggle && !langToggle._bound) {
              langToggle.addEventListener('click', function() {
                var current = localStorage.getItem('locale') || savedLocale || 'cn';
                if (current === 'zh') current = 'cn';
                var next = current === 'cn' ? 'en' : 'cn';
                localStorage.setItem('locale', next);
                applyLocale(next);
                langToggle.textContent = next === 'en' ? 'EN' : 'CN';
              });
              langToggle._bound = true;
            }
          } catch (e) {}
        }

        // Initial bind
        bindUi();

        // Custom page transition: fade out to white/black then navigate
        var navLinks = document.querySelectorAll('a[data-nav]');
        var NAV_FADE_MS = 100;
        navLinks.forEach(function(a) {
          if (a._boundNav) return;
          a.addEventListener('click', function(e) {
            var href = a.getAttribute('href');
            if (!href || href.startsWith('#') || e.metaKey || e.ctrlKey) return;
            e.preventDefault();
            var isDark = root.classList.contains('dark');
            root.classList.add(isDark ? 'dark-mask' : 'light-mask', 'is-animating');
            setTimeout(function() { window.location.href = href; }, NAV_FADE_MS);
          });
          a._boundNav = true;
        });

        // Smooth page transitions on load (content only); clear any mask
        window.addEventListener('load', function() {
          var container = document.getElementById('swup');
          if (container) container.classList.remove('opacity-0');
          root.classList.remove('light-mask','dark-mask','is-animating');
        });
      })();
    </script>
  </body>
</html>
